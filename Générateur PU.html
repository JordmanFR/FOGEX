<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur de code article</title>
    <style>
        /* Styles généraux */
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .step {
            display: none;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 20px;
            position: relative;
        }

        .active {
            display: block;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        select {
            padding: 10px;
            margin: 10px 0;
            width: 100%;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        #result {
            font-size: 24px;
            color: green;
            margin-top: 20px;
            padding: 10px;
            border: 2px dashed green;
        }

        #designation {
            font-size: 18px;
            color: #333;
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .back-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #ffcccc;
            border: 1px solid #ff6666;
        }

        .back-button:hover {
            background-color: #ff9999;
        }

        .error {
            color: red;
            display: none;
        }

        .error-visible {
            display: block;
        }

        .error-code {
            color: red;
        }

        /* Styles pour la barre de progression */
        #progressBar {
            width: 100%;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        #progress {
            width: 0%; /* La largeur sera mise à jour dynamiquement */
            height: 10px;
            background-color: #4caf50; /* Couleur de la barre de progression */
            border-radius: 5px;
            transition: width 0.3s ease; /* Animation fluide */
        }
    </style>
</head>
<body>
    <h1>Générateur de code article</h1>

    <!-- Barre de progression -->
    <div id="progressBar">
        <div id="progress"></div>
    </div>

    <!-- Étape 1: Sélection de la catégorie -->
    <div class="step active" id="step1">
        <h3>Étape 1: Sélectionnez la catégorie</h3>
        <button onclick="selectOption('','R', 2)">Courroie ouverte</button>
        <button onclick="selectOption('','V', 2)">Courroie soudée</button>
        <button onclick="selectOption('','F', 2)">Courroie flex</button>
    </div>

    <!-- Étape 2: Sélection du profil -->
    <div class="step" id="step2">
        <button class="back-button" onclick="goBack(1)">Retour</button>
        <h3>Étape 2: Sélectionnez le profil</h3>
        <select id="profileSelect" onchange="updateStep3Options()">
            <optgroup label="Profil T">
                <option value="T2.5">T2.5</option>
                <option value="T5">T5</option>
                <option value="T10">T10</option>
                <option value="T20">T20</option>
            </optgroup>
            <optgroup label="Profil AT">
                <option value="AT3">AT3</option>
                <option value="AT5">AT5</option>
                <option value="AT10">AT10</option>
                <option value="AT15">AT15</option>
                <option value="AT20">AT20</option>
            </optgroup>
            <optgroup label="Profil HTD">
                <option value="HT5">HTD 5M</option>
                <option value="HT8">HTD 8M</option>
                <option value="HT14">HTD 14M</option>
            </optgroup>
            <optgroup label="Profil STD">
                <option value="ST5">STD 5M</option>
                <option value="ST8">STD 8M</option>
                <option value="ST14">STD 14M</option>
            </optgroup>
            <optgroup label="Profil RTD">
                <option value="RP5">RTD 5M</option>
                <option value="RP8">RTD 8M</option>
                <option value="RP14">RTD 14M</option>
            </optgroup>
            <optgroup label="Profil EAGLE">
                <option value="E5">EAGLE 5M</option>
                <option value="E8">EAGLE 8M</option>
                <option value="E10">EAGLE 10M</option>
                <option value="E14">EAGLE 14M</option>
            </optgroup>
            <optgroup label="Profil MXL / XL / L / H / XH">
                <option value="MXL">MXL</option>
                <option value="XL">XL</option>
                <option value="L">L</option>
                <option value="H">H</option>
                <option value="XH">XH</option>
            </optgroup>
        </select>
        <button onclick="selectProfile()">Suivant</button>
    </div>

    <!-- Étape 3: Sélection de la largeur -->
    <div class="step" id="step3">
        <button class="back-button" onclick="goBack(2)">Retour</button>
        <h3>Étape 3: Sélectionnez la largeur</h3>
        <div id="widthOptions"></div>
    </div>

    <!-- Étape 4: Sélection du câble -->
    <div class="step" id="step4">
        <button class="back-button" onclick="goBack(3)">Retour</button>
        <h3>Étape 4 : Sélectionnez le câble</h3>
        <button onclick="selectOption('','A', 5)">Acier (par défaut)</button>
        <button onclick="selectOption('','K', 5)">Kevlar</button>
        <button onclick="selectOption('','S', 5)">Inox</button>
    </div>

    <!-- Étape 5: Saisie de la longueur -->
    <div class="step" id="step5">
        <button class="back-button" onclick="goBack(4)">Retour</button>
        <h3>Étape 5: Entrez la longueur (5 caractères max)</h3>
        <input type="text" id="sizeInput" placeholder="Entrez la longueur en mm" maxlength="5">
        <div id="sizeError" class="error">Veuillez entrer une taille valide.</div>
        <div id="lengthError" class="error">La longueur doit être supérieure ou égale à 1000 mm.</div>
        <div id="teethError" class="error">La longueur saisie ne donne pas un nombre de dents entier.</div>
        <button onclick="validateSize()">Valider</button>
    </div>

    <!-- Résultat -->
    <div id="result"></div>
    <div id="designation"></div>

    <script>
        // Variables globales
        let codeArticle = '';
        let currentStep = 1;
        let category = '';
        let width = '';
        let profile = '';
        let cable = '';
        let size = '';
        let errors = [];

        // Options de largeur pour chaque profil
        const widthOptions = {
            "T2.5": ["004", "006", "010", "020", "050", "100"],
            "T5": ["010", "016", "025", "032", "050", "075", "100"],
            "T10": ["010", "016", "025", "032", "050", "075", "100"],
            "T20": ["025", "032", "050", "075", "100"],
            "AT3": ["008", "010", "012", "016", "020", "025", "050", "100"],
            "AT5": ["010", "016", "025", "032", "050", "075", "100"],
            "AT10": ["010", "016", "025", "032", "050", "075", "100"],
            "AT15": ["050", "075", "100"],
            "AT20": ["025", "032", "050", "075", "100"],
            "HT3": ["010", "015", "025", "050", "100"],
            "HT5": ["010", "015", "025", "050", "100"],
            "HT8": ["020", "030", "050", "085", "100"],
            "HT14": ["040", "055", "085", "0115", "150"],
            "ST5": ["010", "015", "025", "050", "100"],
            "ST8": ["020", "030", "050", "085", "100"],
            "ST14": ["040", "055", "085", "0115", "150"],
            "RP5": ["010", "015", "025", "050", "100"],
            "RP8": ["020", "030", "050", "085", "100"],
            "RP14": ["040", "055", "085", "0115", "150"],
            "E5": ["012.5", "025"],
            "E8": ["016", "025", "032", "050"],
            "E10": ["025", "032", "050", "075", "100"],
            "E14": ["035", "052", "070", "105"],
            "MXL": ["025","050", "100","200","400"],
            "XL": ["025","050", "100","200","400"],
            "L": ["050","075", "100","200","400"],
            "H": ["050","075", "100","200","400"],
            "XH": ["100", "200", "400"]
        };

        // Pas pour chaque profil (en mm par dent)
        const profilePitch = {
            "T2.5": 2.5,
            "T5": 5,
            "T10": 10,
            "T20": 20,
            "AT3": 3,
            "AT5": 5,
            "AT10": 10,
            "AT15": 15,
            "AT20": 20,
            "HT3": 3,
            "HT5": 5,
            "HT8": 8,
            "HT14": 14,
            "ST5": 5,
            "ST8": 8,
            "ST14": 14,
            "RP5": 5,
            "RP8": 8,
            "RP14": 14,
            "E5": 5,
            "E8": 8,
            "E10": 10,
            "E14": 14,
            "MXL": 2.032,
            "XL": 5.08,
            "L": 9.525,
            "H": 12.7,
            "XH": 22.225
        };

        // Fonction pour mettre à jour la barre de progression
        function updateProgress(step) {
            const totalSteps = 5; // Nombre total d'étapes
            const progressWidth = (step / totalSteps) * 100; // Calcul de la largeur en pourcentage
            document.getElementById('progress').style.width = `${progressWidth}%`;
        }

        // Fonction pour sélectionner une option
        function selectOption(prefix, value, nextStep) {
            if (currentStep === 1) category = value;
            if (currentStep === 3) width = value;
            if (currentStep === 4) cable = value;

            // Construire le code article
            if (category === 'R') {
                codeArticle = category + width + profile + cable;
            } else {
                codeArticle = category + width + profile + cable + size;
            }

            // Masquer l'étape actuelle
            document.getElementById('step' + currentStep).classList.remove('active');

            if (nextStep > 5) {
                showResult();
                return;
            }

            // Afficher la prochaine étape
            currentStep = nextStep;
            document.getElementById('step' + currentStep).classList.add('active');

            // Mettre à jour la barre de progression
            updateProgress(currentStep);
        }

        // Fonction pour revenir à l'étape précédente
        function goBack(previousStep) {
            document.getElementById('step' + currentStep).classList.remove('active');
            currentStep = previousStep;
            document.getElementById('step' + currentStep).classList.add('active');
            updateProgress(currentStep);
        }

        // Fonction pour sélectionner le profil et passer à l'étape 3
        function selectProfile() {
            const profileSelect = document.getElementById('profileSelect');
            const selectedProfile = profileSelect.value;
            profile = selectedProfile; // Stocker le profil sélectionné

            // Mettre à jour les options de largeur pour l'étape 3
            updateStep3Options();

            // Passer à l'étape 3
            document.getElementById('step2').classList.remove('active');
            currentStep = 3;
            document.getElementById('step3').classList.add('active');

            // Mettre à jour la barre de progression
            updateProgress(currentStep);
        }

        // Fonction pour mettre à jour les options de largeur
        function updateStep3Options() {
            const profileSelect = document.getElementById('profileSelect');
            const selectedProfile = profileSelect.value;
            const widthOptionsDiv = document.getElementById('widthOptions');

            // Vider les options précédentes
            widthOptionsDiv.innerHTML = '';

            // Ajouter les nouvelles options en fonction du profil sélectionné
            widthOptions[selectedProfile].forEach(width => {
                const button = document.createElement('button');
                button.textContent = `${width}mm`;
                button.onclick = () => selectOption('', width, 4);
                widthOptionsDiv.appendChild(button);
            });
        }

        // Fonction pour valider la taille
        function validateSize() {
            const sizeInput = document.getElementById('sizeInput').value.trim();
            const sizeError = document.getElementById('sizeError');
            const lengthError = document.getElementById('lengthError');
            const teethError = document.getElementById('teethError');

            // Réinitialiser les erreurs
            errors = [];
            sizeError.style.display = 'none';
            lengthError.style.display = 'none';
            teethError.style.display = 'none';

            // Validation de la taille
            if (!sizeInput || isNaN(sizeInput) || sizeInput.length > 5) {
                errors.push('sizeError');
                sizeError.style.display = 'block';
            }

            // Validation de la longueur minimale
            if (parseInt(sizeInput) < 1000) {
                errors.push('lengthError');
                lengthError.style.display = 'block';
            }

            // Validation du nombre de dents
            if (!errors.includes('sizeError')) {
                const pitch = profilePitch[profile] || 1; // Pas par défaut si non trouvé
                const lengthInMm = parseInt(sizeInput, 10); // Convertir la taille en nombre
                const numberOfTeeth = lengthInMm / pitch; // Calculer le nombre de dents

                if (!Number.isInteger(numberOfTeeth)) {
                    errors.push('teethError');
                    teethError.style.display = 'block';
                }
            }

            // Si aucune erreur, passer à l'étape suivante
            if (errors.length === 0) {
                // Compléter avec des zéros devant pour atteindre 5 caractères
                const paddedSize = sizeInput.padStart(5, '0').toUpperCase();
                size = paddedSize; // Stocker la taille

                // Construire le code article
                if (category === 'R') {
                    codeArticle = category + width + profile + cable; // Pas de size pour "Courroie ouverte"
                } else {
                    codeArticle = category + width + profile + cable + size;
                }

                // Afficher le résultat
                showResult();
            }
        }

        // Fonction pour afficher le résultat
        function showResult() {
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = `Votre code article : <strong>${codeArticle}</strong>`;

            // Générer et afficher la désignation
            const designation = generateDesignation();
            document.getElementById('designation').innerHTML = `Désignation : <strong>${designation}</strong>`;

            // Afficher les erreurs
            document.querySelectorAll('.error').forEach(el => el.classList.remove('error-visible'));
            errors.forEach(error => {
                document.getElementById(error).classList.add('error-visible');
            });

            // Appliquer la classe d'erreur si une erreur de dents est présente
            if (errors.includes('teethError')) {
                resultElement.classList.add('error-code');
            } else {
                resultElement.classList.remove('error-code');
            }
        }

        // Fonction pour générer la désignation
        function generateDesignation() {
            let designation = '';

            // Ajouter la catégorie
            if (category === 'R') designation += 'Courroie ouverte Elatech - ';
            else if (category === 'V') designation += 'Courroie soudée Elatech - ';
            else if (category === 'F') designation += 'Courroie ELAFLEX - ';

            // Ajouter le profil
            designation += `${profile} - `;

            // Ajouter la largeur
            designation += `${width}mm - `;

            // Ajouter le câble
            if (cable === 'A') designation += 'Cable Acier ';
            else if (cable === 'K') designation += 'Cable Kevlar ';
            else if (cable === 'S') designation += 'Cable Inox ';

            // Ajouter le nombre de dents uniquement si ce n'est pas une courroie ouverte
            if (category !== 'R') {
                const pitch = profilePitch[profile] || 1; // Pas par défaut si non trouvé
                const lengthInMm = parseInt(size, 10); // Convertir la taille en nombre
                const numberOfTeeth = Math.round(lengthInMm / pitch); // Calculer le nombre de dents
                designation += `- ${numberOfTeeth} dents`;
            }

            return designation;
        }

        // Initialiser la barre de progression au chargement de la page
        document.addEventListener('DOMContentLoaded', function () {
            updateProgress(1); // Commencer à l'étape 1
        });
    </script>
</body>
</html>
